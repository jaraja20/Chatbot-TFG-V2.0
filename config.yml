# ============================================
# CONFIGURACIÓN DE RASA PARA CHATBOT CÉDULAS
# Español (Paraguay) - Asistente Inteligente
# ============================================

recipe: default.v1
assistant_id: chatbot-cedula-cde
language: es

# ===============================
# PIPELINE DE NLU (ENTENDIMIENTO)
# ===============================
pipeline:
  - name: WhitespaceTokenizer
  - name: RegexFeaturizer
  - name: LexicalSyntacticFeaturizer
  - name: CountVectorsFeaturizer
  - name: CountVectorsFeaturizer
    analyzer: char_wb
    min_ngram: 1
    max_ngram: 4
  - name: DIETClassifier
    epochs: 120
    constrain_similarities: true
    entity_recognition: true
  - name: EntitySynonymMapper
  - name: FallbackClassifier
    threshold: 0.25        # sensibilidad para entender frases
    ambiguity_threshold: 0.1

# ===============================
# POLÍTICAS DE DIÁLOGO (GESTIÓN)
# ===============================
policies:
  - name: MemoizationPolicy

  # política principal basada en reglas
  - name: RulePolicy
    core_fallback_action_name: "action_fallback_contexto"   # tu acción de fallback personalizada
    core_fallback_threshold: 0.3
    enable_fallback_prediction: true

  # aprendizaje conversacional (manejo de contexto)
  - name: UnexpecTEDIntentPolicy
    max_history: 5
    epochs: 100

  # política de transformador de diálogo
  - name: TEDPolicy
    max_history: 5
    epochs: 150
    constrain_similarities: true


# ===============================
# CANALES DE COMUNICACIÓN
# ===============================
rest:

rasa:
  url: "http://localhost:5002/api"

# ===============================
# ENDPOINT DE ACCIONES
# ===============================
action_endpoint:
  url: "http://localhost:5055/webhook"

# ===============================
# OPCIONAL: TRACKER / EVENTOS
# ===============================
# tracker_store:
#   type: sql
#   dialect: "postgresql"
#   url: "postgresql://botuser:root@localhost:5432/chatbotdb"
#   username: "botuser"
#   password: "root"
#   db: "chatbotdb"
#   driver: "psycopg2"

# event_broker:
#   url: localhost
#   username: username
#   password: password
#   queue: queue
